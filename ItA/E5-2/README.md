# E5-2 逃离迷宫
## 题目描述
小明被困在一个迷宫之中，迷宫中共有$N$个点，标号分别为$1,2,3, \cdots ,N$，且迷宫只有一个出口。$N$个点之间互相有一些道路连通（单向），两个点之间可能有多条道路连通，但是并不存在一条两端都是同一个点的道路。小明希望知道从当前位置$S$去往出口$T$的最短距离是多少。如果不存在去往出口的道路，输出$-1$

## 输入格式
第一行为4个整数，$N\ M\ S\ T$，分别代表节点个数、道路条数、小明当前所处的位置的标号、出口标号

接下来$M$行，每行表述一条道路，表述为$U_i$$V_i$$W_i$的形式，表示一条从$U_i$到$V_i$，距离为$W_i$的单向边

## 输出格式
如果小明能逃离迷宫，输出从他的位置到出口的最短距离；

否则输出$-1$

## 数据规模：
对于所有数据，满足$1 \leq U_i \leq N$，$1 \leq V_i \leq N$，$1 \leq W_i \leq 100$

$30\%$的数据，$2 \leq N \leq 100$，$2 \leq M \leq 500$
$60\%$的数据，$2 \leq N \leq 1000$，$2 \leq M \leq 20000$
$100\%$的数据，$2 \leq N \leq 10^{5}$，$2 \leq M \leq 10^{6}$

# 解题报告
## 初始思路
这是一道加权有向无环图中的单源最短路径问题，注意到边权非负，因此使用*Dijkstra*算法即可解决。注意到在$100\%$的数据中，边数$M$的数量级不超过结点数$N$的数量级加一，因此我们讨论的是稀疏图，则可以使用堆优化的*Dijkstra*算法，使用最小优先队列来维护源点到各结点距离，进而改善算法的运行时间。

考虑数据结构性能，使用链式前向星存放图的信息：
```c++
// 链式前向星
struct edge
{
    int to;       // 终点
    int length;   // 边的长度
    int nextEdge; // 下一条相同起点边的下标
} Edge[M];        // 边

int First_Edge_from[N]; // 以结点作为起点的边的下标
```
## 提交与修改过程
由于本题较为简单，首次提交即[Accepted](https://202.38.86.171/status/239074cf665597b258e4fd4de0f7a859)，第10个数据点耗时420ms。

## 算法分析
### 时间复杂度
考虑到*Fibonacci*堆的实现与维护较为复杂，完成本题时使用了STL提供的优先队列实现算法所需的对应结构，其内部实现基于高度优化的红黑树，性能与二叉堆一致，因此算法总的时间复杂度是$O((N+M)\lg{M})$。

### 空间复杂度
算法中使用了链式前向星的结构存放图，维护了结构体数组`Edge`、整型数组`FirstEdgeFrom`与`Distance`以及布尔型数组`IfVisited`，另外维护了最小优先队列，因此消耗的额外空间为$O(N + M)$。

## 总结
本题是基本的有向图单源最短路径的算法实现，由于边权非负，因此使用*Dijkstra*算法解决，算法中使用了多相关数组的方式模拟了邻接链表中对于以某顶点为起点的所有边的访问。