# E3-EX 正方形计数
## 题目描述
现有一个$n\times m$的矩形区域，其中每个单位区域可能有损坏。

要求找到地面上所有不包含损坏区域的正方形的个数。

## 输入格式
第一行两个整数$n,\,m$表示矩形区域的大小。

接下来共有$n$行输入数据，每行包含$m$个$0$或$1$的整数，其中$0$表示该地面完好，$1$表示该地面已损坏。

## 输出格式
输出一个整数表示区域内的正方形个数。

## 数据规模：

$0 < n,\,m \leq 2000$

# 解题报告
## 初始思路
这是一道二维的动态规划题目，设$F_{i,j}$表示从$A_{1,1}$到$A_{i,j}$范围内，可构成的正方形个数，则给出状态转移方程

$$
F_{i,j} =
\begin{cases}
	& F_{i, j - 1} + F_{i - 1, j} - F_{i - 1, j - 1}, & A_{i,j} = 1 \\
	& F_{i, j - 1} + F_{i - 1, j} - F_{i - 1, j - 1} + 1, & A_{i,j} = 0
\end{cases}
$$

## 提交与修改过程
首次提交[PA](https://202.38.86.171/status/def2daf50c64de496bc0f0968cba3e48)，仅有前4个数据点通过，其余为Wrong Answer。

问题出现在当有$3 \times 3$及以上的正方形出现时，上述状态转移方程无法将其计算在内。本质上前述状态转移方程中的常数项即**A_{i-1,j-1}、A_{i-1,j}、A_{i,j-1}、A_{i,j}是否构成一个$2 \times 2$的正方形**。为解决这一问题，考虑计算**以$A_{i,j}$为右下角的正方形个数**，具体实现是将状态表设计为具有4个属性的结构体二维数组：
```c++
struct DynamicProgram
{
    int number; // 以点(i,j)为右下角，可构成的正方形个数
    int column; // 从(i,j)向上连续的0的个数
    int row;    // 从(i,j)向左连续的0的个数
    int total;  // (0,0)->(i,j) 范围内正方形个数
} F[N + 1][M + 1];
```

给出状态转移方程组：

$$
Number_{i,j} =
\begin{cases}
	& \min{ \{ Number_{i - 1, j - 1}, Column_{i - 1, j}, Row_{i, j - 1} \} } + 1, & A_{i,j} = 0 \\
	& 0, & A_{i,j} = 1
\end{cases}

Column_{i,j} =
\begin{cases}
	& Column_{i - 1, j} + 1, & A_{i,j} = 0 \\
	& 0, & A_{i,j} = 1
\end{cases}

Row_{i,j} =
\begin{cases}
	& Row_{i, j - 1} + 1, & A_{i,j} = 0 \\
	& 0, & A_{i,j} = 1
\end{cases}

Total_{i,j} =
\begin{cases}
	& Total_{i, j - 1} + Total_{i - 1, j} - Total_{i - 1, j - 1} + Number_{i, j}, & A_{i,j} = 0 \\
	& Total_{i, j - 1} + Total_{i - 1, j} - Total_{i - 1, j - 1}, & A_{i,j} = 0
\end{cases}
$$

修改代码后，再次提交即[AC](https://202.38.86.171/status/3d706601d0a400ec18cea3c412ab5a6d)。

## 算法分析
### 时间复杂度
算法需要两重循环以确定状态表的值，消耗的时间是$O(n \times m)$。
### 空间复杂度
考虑到以二维数组实现动态规划，空间复杂度是$O(n \times m)$

## 总结
在棋盘类的动态规划题目中，如本题要求计数的题目可能需要维护更多的标志值来**以空间换时间**。在采用了修改后的状态转移方程组后，由于维护了以$A_{i,j}$为右下角的正方形个数，可以省略对于`A[i][j]`的存储，转而使用一个变量实现。